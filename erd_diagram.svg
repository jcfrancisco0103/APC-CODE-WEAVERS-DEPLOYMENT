<?xml version="1.0" encoding="UTF-8"?>
<svg width="1800" height="1400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .entity-box { fill: #f8f9fa; stroke: #343a40; stroke-width: 2; }
      .entity-title { fill: #495057; font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; }
      .entity-field { fill: #6c757d; font-family: Arial, sans-serif; font-size: 11px; }
      .primary-key { fill: #dc3545; font-weight: bold; }
      .foreign-key { fill: #007bff; }
      .relationship-line { stroke: #6c757d; stroke-width: 1.5; fill: none; }
      .relationship-text { fill: #495057; font-family: Arial, sans-serif; font-size: 10px; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="900" y="30" text-anchor="middle" class="entity-title" style="font-size: 20px;">E-Commerce System - Entity Relationship Diagram</text>
  
  <!-- User Entity (Django built-in) -->
  <rect x="50" y="60" width="180" height="120" class="entity-box"/>
  <text x="140" y="80" text-anchor="middle" class="entity-title">User</text>
  <text x="60" y="100" class="primary-key">id (PK)</text>
  <text x="60" y="115" class="entity-field">username</text>
  <text x="60" y="130" class="entity-field">email</text>
  <text x="60" y="145" class="entity-field">first_name</text>
  <text x="60" y="160" class="entity-field">last_name</text>
  <text x="60" y="175" class="entity-field">is_staff</text>
  
  <!-- Customer Entity -->
  <rect x="300" y="60" width="200" height="180" class="entity-box"/>
  <text x="400" y="80" text-anchor="middle" class="entity-title">Customer</text>
  <text x="310" y="100" class="primary-key">id (PK)</text>
  <text x="310" y="115" class="foreign-key">user_id (FK)</text>
  <text x="310" y="130" class="entity-field">profile_pic</text>
  <text x="310" y="145" class="entity-field">region</text>
  <text x="310" y="160" class="entity-field">province</text>
  <text x="310" y="175" class="entity-field">citymun</text>
  <text x="310" y="190" class="entity-field">barangay</text>
  <text x="310" y="205" class="entity-field">street_address</text>
  <text x="310" y="220" class="entity-field">postal_code</text>
  <text x="310" y="235" class="entity-field">mobile</text>
  
  <!-- Product Entity -->
  <rect x="600" y="60" width="200" height="200" class="entity-box"/>
  <text x="700" y="80" text-anchor="middle" class="entity-title">Product</text>
  <text x="610" y="100" class="primary-key">id (PK)</text>
  <text x="610" y="115" class="entity-field">name</text>
  <text x="610" y="130" class="entity-field">description</text>
  <text x="610" y="145" class="entity-field">price</text>
  <text x="610" y="160" class="entity-field">category</text>
  <text x="610" y="175" class="entity-field">image</text>
  <text x="610" y="190" class="entity-field">is_active</text>
  <text x="610" y="205" class="entity-field">created_at</text>
  <text x="610" y="220" class="entity-field">updated_at</text>
  <text x="610" y="235" class="entity-field">sizes</text>
  <text x="610" y="250" class="entity-field">colors</text>
  
  <!-- InventoryItem Entity -->
  <rect x="850" y="60" width="180" height="140" class="entity-box"/>
  <text x="940" y="80" text-anchor="middle" class="entity-title">InventoryItem</text>
  <text x="860" y="100" class="primary-key">id (PK)</text>
  <text x="860" y="115" class="foreign-key">product_id (FK)</text>
  <text x="860" y="130" class="entity-field">size</text>
  <text x="860" y="145" class="entity-field">color</text>
  <text x="860" y="160" class="entity-field">quantity</text>
  <text x="860" y="175" class="entity-field">reserved_quantity</text>
  <text x="860" y="190" class="entity-field">updated_at</text>
  
  <!-- CartItem Entity -->
  <rect x="50" y="300" width="180" height="120" class="entity-box"/>
  <text x="140" y="320" text-anchor="middle" class="entity-title">CartItem</text>
  <text x="60" y="340" class="primary-key">id (PK)</text>
  <text x="60" y="355" class="foreign-key">customer_id (FK)</text>
  <text x="60" y="370" class="foreign-key">product_id (FK)</text>
  <text x="60" y="385" class="entity-field">size</text>
  <text x="60" y="400" class="entity-field">quantity</text>
  <text x="60" y="415" class="entity-field">created_at</text>
  
  <!-- Orders Entity -->
  <rect x="300" y="300" width="220" height="280" class="entity-box"/>
  <text x="410" y="320" text-anchor="middle" class="entity-title">Orders</text>
  <text x="310" y="340" class="primary-key">id (PK)</text>
  <text x="310" y="355" class="foreign-key">customer_id (FK)</text>
  <text x="310" y="370" class="entity-field">order_ref</text>
  <text x="310" y="385" class="entity-field">status</text>
  <text x="310" y="400" class="entity-field">total_amount</text>
  <text x="310" y="415" class="entity-field">payment_method</text>
  <text x="310" y="430" class="entity-field">payment_status</text>
  <text x="310" y="445" class="entity-field">shipping_address</text>
  <text x="310" y="460" class="entity-field">shipping_fee</text>
  <text x="310" y="475" class="entity-field">delivery_date</text>
  <text x="310" y="490" class="entity-field">delivery_proof_photo</text>
  <text x="310" y="505" class="entity-field">customer_received_at</text>
  <text x="310" y="520" class="entity-field">created_at</text>
  <text x="310" y="535" class="entity-field">updated_at</text>
  <text x="310" y="550" class="entity-field">cancelled_at</text>
  <text x="310" y="565" class="entity-field">cancellation_reason</text>
  
  <!-- OrderItem Entity -->
  <rect x="600" y="300" width="180" height="140" class="entity-box"/>
  <text x="690" y="320" text-anchor="middle" class="entity-title">OrderItem</text>
  <text x="610" y="340" class="primary-key">id (PK)</text>
  <text x="610" y="355" class="foreign-key">order_id (FK)</text>
  <text x="610" y="370" class="foreign-key">product_id (FK)</text>
  <text x="610" y="385" class="entity-field">quantity</text>
  <text x="610" y="400" class="entity-field">price</text>
  <text x="610" y="415" class="entity-field">size</text>
  <text x="610" y="430" class="entity-field">created_at</text>
  
  <!-- Wishlist Entity -->
  <rect x="850" y="300" width="180" height="100" class="entity-box"/>
  <text x="940" y="320" text-anchor="middle" class="entity-title">Wishlist</text>
  <text x="860" y="340" class="primary-key">id (PK)</text>
  <text x="860" y="355" class="foreign-key">customer_id (FK)</text>
  <text x="860" y="370" class="foreign-key">product_id (FK)</text>
  <text x="860" y="385" class="entity-field">created_at</text>
  
  <!-- ProductReview Entity -->
  <rect x="1100" y="60" width="180" height="140" class="entity-box"/>
  <text x="1190" y="80" text-anchor="middle" class="entity-title">ProductReview</text>
  <text x="1110" y="100" class="primary-key">id (PK)</text>
  <text x="1110" y="115" class="foreign-key">customer_id (FK)</text>
  <text x="1110" y="130" class="foreign-key">product_id (FK)</text>
  <text x="1110" y="145" class="entity-field">rating</text>
  <text x="1110" y="160" class="entity-field">review_text</text>
  <text x="1110" y="175" class="entity-field">created_at</text>
  <text x="1110" y="190" class="entity-field">updated_at</text>
  
  <!-- SavedAddress Entity -->
  <rect x="50" y="460" width="180" height="160" class="entity-box"/>
  <text x="140" y="480" text-anchor="middle" class="entity-title">SavedAddress</text>
  <text x="60" y="500" class="primary-key">id (PK)</text>
  <text x="60" y="515" class="foreign-key">customer_id (FK)</text>
  <text x="60" y="530" class="entity-field">region</text>
  <text x="60" y="545" class="entity-field">province</text>
  <text x="60" y="560" class="entity-field">citymun</text>
  <text x="60" y="575" class="entity-field">barangay</text>
  <text x="60" y="590" class="entity-field">street_address</text>
  <text x="60" y="605" class="entity-field">postal_code</text>
  <text x="60" y="620" class="entity-field">is_default</text>
  
  <!-- Address Entity -->
  <rect x="300" y="640" width="180" height="140" class="entity-box"/>
  <text x="390" y="660" text-anchor="middle" class="entity-title">Address</text>
  <text x="310" y="680" class="primary-key">id (PK)</text>
  <text x="310" y="695" class="entity-field">region</text>
  <text x="310" y="710" class="entity-field">province</text>
  <text x="310" y="725" class="entity-field">city_municipality</text>
  <text x="310" y="740" class="entity-field">barangay</text>
  <text x="310" y="755" class="entity-field">street</text>
  <text x="310" y="770" class="entity-field">postal_code</text>
  
  <!-- ShippingFee Entity -->
  <rect x="550" y="640" width="180" height="120" class="entity-box"/>
  <text x="640" y="660" text-anchor="middle" class="entity-title">ShippingFee</text>
  <text x="560" y="680" class="primary-key">id (PK)</text>
  <text x="560" y="695" class="entity-field">courier</text>
  <text x="560" y="710" class="entity-field">origin_region</text>
  <text x="560" y="725" class="entity-field">destination_region</text>
  <text x="560" y="740" class="entity-field">weight_kg</text>
  <text x="560" y="755" class="entity-field">price_php</text>
  
  <!-- Feedback Entity -->
  <rect x="800" y="640" width="180" height="120" class="entity-box"/>
  <text x="890" y="660" text-anchor="middle" class="entity-title">Feedback</text>
  <text x="810" y="680" class="primary-key">id (PK)</text>
  <text x="810" y="695" class="foreign-key">customer_id (FK)</text>
  <text x="810" y="710" class="entity-field">subject</text>
  <text x="810" y="725" class="entity-field">message</text>
  <text x="810" y="740" class="entity-field">created_at</text>
  <text x="810" y="755" class="entity-field">is_resolved</text>
  
  <!-- Newsletter Entity -->
  <rect x="1050" y="640" width="180" height="80" class="entity-box"/>
  <text x="1140" y="660" text-anchor="middle" class="entity-title">Newsletter</text>
  <text x="1060" y="680" class="primary-key">id (PK)</text>
  <text x="1060" y="695" class="entity-field">email</text>
  <text x="1060" y="710" class="entity-field">is_active</text>
  <text x="1060" y="725" class="entity-field">created_at</text>
  
  <!-- ChatSession Entity -->
  <rect x="1300" y="60" width="200" height="180" class="entity-box"/>
  <text x="1400" y="80" text-anchor="middle" class="entity-title">ChatSession</text>
  <text x="1310" y="100" class="primary-key">id (PK)</text>
  <text x="1310" y="115" class="entity-field">session_id</text>
  <text x="1310" y="130" class="foreign-key">customer_id (FK)</text>
  <text x="1310" y="145" class="foreign-key">admin_user_id (FK)</text>
  <text x="1310" y="160" class="entity-field">handover_status</text>
  <text x="1310" y="175" class="entity-field">is_active</text>
  <text x="1310" y="190" class="entity-field">created_at</text>
  <text x="1310" y="205" class="entity-field">updated_at</text>
  <text x="1310" y="220" class="entity-field">handover_requested_at</text>
  <text x="1310" y="235" class="entity-field">admin_joined_at</text>
  
  <!-- ChatMessage Entity -->
  <rect x="1550" y="60" width="180" height="140" class="entity-box"/>
  <text x="1640" y="80" text-anchor="middle" class="entity-title">ChatMessage</text>
  <text x="1560" y="100" class="primary-key">id (PK)</text>
  <text x="1560" y="115" class="foreign-key">session_id (FK)</text>
  <text x="1560" y="130" class="foreign-key">admin_user_id (FK)</text>
  <text x="1560" y="145" class="entity-field">message_type</text>
  <text x="1560" y="160" class="entity-field">content</text>
  <text x="1560" y="175" class="entity-field">timestamp</text>
  <text x="1560" y="190" class="entity-field">is_helpful</text>
  
  <!-- ChatbotKnowledge Entity -->
  <rect x="1300" y="280" width="180" height="140" class="entity-box"/>
  <text x="1390" y="300" text-anchor="middle" class="entity-title">ChatbotKnowledge</text>
  <text x="1310" y="320" class="primary-key">id (PK)</text>
  <text x="1310" y="335" class="entity-field">category</text>
  <text x="1310" y="350" class="entity-field">keywords</text>
  <text x="1310" y="365" class="entity-field">question</text>
  <text x="1310" y="380" class="entity-field">answer</text>
  <text x="1310" y="395" class="entity-field">is_active</text>
  <text x="1310" y="410" class="entity-field">created_at</text>
  
  <!-- DeliveryMagicLink Entity -->
  <rect x="1050" y="460" width="200" height="120" class="entity-box"/>
  <text x="1150" y="480" text-anchor="middle" class="entity-title">DeliveryMagicLink</text>
  <text x="1060" y="500" class="primary-key">id (PK)</text>
  <text x="1060" y="515" class="foreign-key">order_id (FK)</text>
  <text x="1060" y="530" class="entity-field">token</text>
  <text x="1060" y="545" class="entity-field">created_at</text>
  <text x="1060" y="560" class="entity-field">expires_at</text>
  <text x="1060" y="575" class="entity-field">is_active</text>
  
  <!-- DeliveryStatusLog Entity -->
  <rect x="1300" y="460" width="200" height="140" class="entity-box"/>
  <text x="1400" y="480" text-anchor="middle" class="entity-title">DeliveryStatusLog</text>
  <text x="1310" y="500" class="primary-key">id (PK)</text>
  <text x="1310" y="515" class="foreign-key">order_id (FK)</text>
  <text x="1310" y="530" class="entity-field">previous_status</text>
  <text x="1310" y="545" class="entity-field">new_status</text>
  <text x="1310" y="560" class="entity-field">updated_by</text>
  <text x="1310" y="575" class="entity-field">update_method</text>
  <text x="1310" y="590" class="entity-field">timestamp</text>
  
  <!-- BulkOrderOperation Entity -->
  <rect x="1550" y="460" width="200" height="160" class="entity-box"/>
  <text x="1650" y="480" text-anchor="middle" class="entity-title">BulkOrderOperation</text>
  <text x="1560" y="500" class="primary-key">id (PK)</text>
  <text x="1560" y="515" class="foreign-key">performed_by_id (FK)</text>
  <text x="1560" y="530" class="entity-field">operation_type</text>
  <text x="1560" y="545" class="entity-field">parameters</text>
  <text x="1560" y="560" class="entity-field">created_at</text>
  <text x="1560" y="575" class="entity-field">completed_at</text>
  <text x="1560" y="590" class="entity-field">success_count</text>
  <text x="1560" y="605" class="entity-field">error_count</text>
  
  <!-- Relationships -->
  
  <!-- User to Customer (1:1) -->
  <line x1="230" y1="120" x2="300" y2="120" class="relationship-line"/>
  <text x="265" y="115" class="relationship-text">1:1</text>
  
  <!-- Customer to CartItem (1:N) -->
  <line x1="300" y1="200" x2="140" y2="300" class="relationship-line"/>
  <text x="220" y="250" class="relationship-text">1:N</text>
  
  <!-- Product to CartItem (1:N) -->
  <line x1="600" y1="200" x2="230" y2="360" class="relationship-line"/>
  <text x="415" y="280" class="relationship-text">1:N</text>
  
  <!-- Customer to Orders (1:N) -->
  <line x1="400" y1="240" x2="400" y2="300" class="relationship-line"/>
  <text x="405" y="270" class="relationship-text">1:N</text>
  
  <!-- Orders to OrderItem (1:N) -->
  <line x1="520" y1="400" x2="600" y2="400" class="relationship-line"/>
  <text x="560" y="395" class="relationship-text">1:N</text>
  
  <!-- Product to OrderItem (1:N) -->
  <line x1="700" y1="260" x2="700" y2="300" class="relationship-line"/>
  <text x="705" y="280" class="relationship-text">1:N</text>
  
  <!-- Product to InventoryItem (1:N) -->
  <line x1="800" y1="120" x2="850" y2="120" class="relationship-line"/>
  <text x="825" y="115" class="relationship-text">1:N</text>
  
  <!-- Customer to Wishlist (1:N) -->
  <line x1="500" y1="200" x2="850" y2="350" class="relationship-line"/>
  <text x="675" y="275" class="relationship-text">1:N</text>
  
  <!-- Product to Wishlist (1:N) -->
  <line x1="800" y1="200" x2="940" y2="300" class="relationship-line"/>
  <text x="870" y="250" class="relationship-text">1:N</text>
  
  <!-- Customer to ProductReview (1:N) -->
  <line x1="500" y1="120" x2="1100" y2="120" class="relationship-line"/>
  <text x="800" y="115" class="relationship-text">1:N</text>
  
  <!-- Product to ProductReview (1:N) -->
  <line x1="800" y1="120" x2="1100" y2="120" class="relationship-line"/>
  <text x="950" y="115" class="relationship-text">1:N</text>
  
  <!-- Customer to SavedAddress (1:N) -->
  <line x1="300" y1="240" x2="140" y2="460" class="relationship-line"/>
  <text x="220" y="350" class="relationship-text">1:N</text>
  
  <!-- Customer to Feedback (1:N) -->
  <line x1="500" y1="240" x2="800" y2="700" class="relationship-line"/>
  <text x="650" y="470" class="relationship-text">1:N</text>
  
  <!-- Customer to ChatSession (1:N) -->
  <line x1="500" y1="120" x2="1300" y2="120" class="relationship-line"/>
  <text x="900" y="115" class="relationship-text">1:N</text>
  
  <!-- User to ChatSession (1:N) - Admin -->
  <line x1="230" y1="80" x2="1300" y2="150" class="relationship-line"/>
  <text x="765" y="115" class="relationship-text">1:N (admin)</text>
  
  <!-- ChatSession to ChatMessage (1:N) -->
  <line x1="1500" y1="120" x2="1550" y2="120" class="relationship-line"/>
  <text x="1525" y="115" class="relationship-text">1:N</text>
  
  <!-- User to ChatMessage (1:N) - Admin -->
  <line x1="230" y1="60" x2="1550" y2="130" class="relationship-line"/>
  <text x="890" y="95" class="relationship-text">1:N (admin)</text>
  
  <!-- Orders to DeliveryMagicLink (1:1) -->
  <line x1="520" y1="440" x2="1050" y2="520" class="relationship-line"/>
  <text x="785" y="480" class="relationship-text">1:1</text>
  
  <!-- Orders to DeliveryStatusLog (1:N) -->
  <line x1="520" y1="460" x2="1300" y2="530" class="relationship-line"/>
  <text x="910" y="495" class="relationship-text">1:N</text>
  
  <!-- User to BulkOrderOperation (1:N) -->
  <line x1="230" y1="60" x2="1550" y2="530" class="relationship-line"/>
  <text x="890" y="295" class="relationship-text">1:N</text>
  
  <!-- Orders to BulkOrderOperation (M:N) -->
  <line x1="520" y1="500" x2="1550" y2="540" class="relationship-line"/>
  <text x="1035" y="520" class="relationship-text">M:N</text>
  
  <!-- Legend -->
  <rect x="50" y="850" width="300" height="120" fill="#f8f9fa" stroke="#343a40" stroke-width="1"/>
  <text x="200" y="870" text-anchor="middle" class="entity-title">Legend</text>
  <text x="60" y="890" class="primary-key">Primary Key (PK)</text>
  <text x="60" y="905" class="foreign-key">Foreign Key (FK)</text>
  <text x="60" y="920" class="entity-field">Regular Field</text>
  <line x1="60" y1="935" x2="100" y2="935" class="relationship-line"/>
  <text x="110" y="940" class="relationship-text">Relationship</text>
  <text x="60" y="955" class="relationship-text">1:1 = One-to-One, 1:N = One-to-Many, M:N = Many-to-Many</text>
  
</svg>